(ns clj-watson.unit.logic.github.vulnerability-test
  (:require
   [clj-watson.logic.github.vulnerability :as logic.gh.vulnerability]
   [clj-watson.test-util :as tu]
   [clojure.test :refer :all]))

(use-fixtures :each tu/pool-debug-fixture)

(deftest is-version-vulnerable?
  (is (= false (logic.gh.vulnerability/is-version-vulnerable? {:mvn/version "1"} {:vulnerableVersionRange "> 0.1, <= 0.4"})))
  (is (= true (logic.gh.vulnerability/is-version-vulnerable? {:mvn/version "0.4"} {:vulnerableVersionRange "> 0.1, <= 0.4"})))
  (is (= true (logic.gh.vulnerability/is-version-vulnerable? {:mvn/version "0.1.1"} {:vulnerableVersionRange "> 0.1, <= 0.4"})))
  (is (= false (logic.gh.vulnerability/is-version-vulnerable? {:mvn/version "0.0.1"} {:vulnerableVersionRange "> 0.1, <= 0.4"}))))
