(ns clj-watson.unit.logic.github.vulnerability-test
  (:require
   [clj-watson.logic.github.vulnerability :as logic.gh.vulnerability]
   [clojure.test :refer :all]))

(deftest is-version-vulnerable?
  (is (= false (logic.gh.vulnerability/is-version-vulnerable? {:mvn/version "1"} {:vulnerableVersionRange "> 0.1, <= 0.4"})))
  (is (= true (logic.gh.vulnerability/is-version-vulnerable? {:mvn/version "0.4"} {:vulnerableVersionRange "> 0.1, <= 0.4"})))
  (is (= true (logic.gh.vulnerability/is-version-vulnerable? {:mvn/version "0.1.1"} {:vulnerableVersionRange "> 0.1, <= 0.4"})))
  (is (= false (logic.gh.vulnerability/is-version-vulnerable? {:mvn/version "0.0.1"} {:vulnerableVersionRange "> 0.1, <= 0.4"}))))

(deftest version-not-vulnerable
  (is (= "3" (logic.gh.vulnerability/version-not-vulnerable [{:firstPatchedVersion {:identifier "3"}}
                                                             {:firstPatchedVersion {:identifier "1.3"}}
                                                             {:firstPatchedVersion {:identifier nil}}
                                                             {:firstPatchedVersion {:identifier "1.1"}}]))))
